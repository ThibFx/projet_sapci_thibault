<section class="pollution-detail" *ngIf="!isLoading(); else loadingTpl">
  <ng-container *ngIf="!error(); else errorTpl">
    <ng-container *ngIf="pollution(); else emptyTpl">
      <header class="pollution-detail__header">
        <div>
          <h1>
            {{ pollution()?.name }}
            <button
              *ngIf="isAuthenticated()"
              type="button"
              class="btn-favorite"
              [class.active]="pollution()?.isFavorite"
              [disabled]="togglingFavorite()"
              (click)="toggleFavorite()"
              [title]="pollution()?.isFavorite ? 'Retirer des favoris' : 'Ajouter aux favoris'"
            >
              {{ pollution()?.isFavorite ? '★' : '☆' }}
            </button>
          </h1>
          <p class="hint">Signalement enregistré le {{ pollution()?.recordedAt | date: 'longDate' }}</p>
        </div>
        <nav>
          <a class="btn" routerLink="/pollutions">Retour à la liste</a>
          <a *ngIf="isAuthenticated()" class="btn primary" [routerLink]="['/pollutions', pollution()?.id, 'edit']">Modifier</a>
        </nav>
      </header>

      <dl class="pollution-detail__grid">
        <div>
          <dt>Type</dt>
          <dd>{{ getTypeLabel(pollution()?.type) }}</dd>
        </div>
        <div>
          <dt>Ville</dt>
          <dd>{{ pollution()?.city }}</dd>
        </div>
        <div>
          <dt>Statut</dt>
          <dd class="status" [attr.data-status]="pollution()?.status">
            {{ getStatusLabel(pollution()?.status) }}
          </dd>
        </div>
      </dl>

      <article class="pollution-detail__description">
        <h2>Description</h2>
        <p>{{ pollution()?.description }}</p>
      </article>

      <article class="pollution-detail__photo" *ngIf="getPhotoUrl()">
        <h2>Photo</h2>
        <img [src]="getPhotoUrl()" alt="Photo de la pollution" class="pollution-photo" />
      </article>

      <article class="pollution-detail__location" *ngIf="pollution()?.latitude && pollution()?.longitude">
        <h2>Localisation</h2>
        <p>
          <strong>Coordonnées:</strong> {{ pollution()?.latitude }}, {{ pollution()?.longitude }}
        </p>
        <p *ngIf="pollution()?.address">
          <strong>Adresse:</strong> {{ pollution()?.address }}
        </p>
      </article>

      <article class="pollution-detail__discoverer" *ngIf="pollution()?.discovererName">
        <h2>Découvreur</h2>
        <p>{{ pollution()?.discovererName }}</p>
      </article>
    </ng-container>
  </ng-container>
</section>

<ng-template #loadingTpl>
  <p class="info">Chargement de la pollution…</p>
</ng-template>

<ng-template #errorTpl>
  <div class="alert error">{{ error() }}</div>
</ng-template>

<ng-template #emptyTpl>
  <div class="alert">Aucune information disponible.</div>
</ng-template>
